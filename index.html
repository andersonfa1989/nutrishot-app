<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>NutriShot Elements</title>

    <!-- AdMob -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6941311170472131" crossorigin="anonymous"></script>

    <style>
        :root { 
            --primary: #2ab573; 
            --blue-action: #2490eb; 
            --bg: #f9fafb; 
            --water: #3498db;
        }
        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: #333;
            padding-bottom: 40px;
            overflow-x: hidden;
        }

        .sidebar { position: fixed; top: 0; left: -280px; width: 280px; height: 100%; background: white; z-index: 10000; transition: 0.3s; box-shadow: 2px 0 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .sidebar.active { left: 0; }
        .sidebar-header { padding: 40px 20px 20px; background: linear-gradient(135deg, var(--blue-action), var(--primary)); color: white; }
        .sidebar-menu { padding: 20px 0; flex-grow: 1; }
        .menu-item { padding: 15px 25px; display: flex; gap: 15px; cursor: pointer; font-weight: 500; }
        .menu-item:hover { background: #f0f7f4; color: var(--primary); }

        .sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 9999; }
        .sidebar-overlay.active { display: block; }

        .card { background: #fff; border-radius: 20px; padding: 20px; margin: 15px 20px; border: 1px solid #eee; }
        .card-fogo { background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; display: flex; justify-content: space-between; align-items: center; }

        .progress-container { width: 100%; height: 10px; background: #eee; border-radius: 10px; margin-top: 10px; overflow: hidden; }
        .progress-bar { height: 100%; background: var(--primary); transition: width .4s; }
        .progress-bar.water { background: var(--water); }

        .grid-7 { display: flex; justify-content: space-between; align-items: flex-end; height: 50px; margin-top: 15px; }
        .col-dia { display: flex; flex-direction: column; align-items: center; flex: 1; }
        .barra-v { width: 28px; height: 4px; background: #eee; border-radius: 2px; }
        .barra-v.active { background: #6a11cb; width: 40px; }
        .dia-txt { font-size: 10px; color: #aaa; margin-top: 5px; }

        .btn-water { background: var(--water); color: white; border: none; padding: 12px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; }

        .ad-banner-container { margin: 20px; text-align: center; background: #eee; border-radius: 15px; min-height: 50px; }

        .fab { position: fixed; bottom: 30px; right: 20px; width: 65px; height: 65px; background: #000; color: #fff; border-radius: 50%; font-size: 30px; border: none; z-index: 99; }
    </style>
</head>

<body>
<div id="app"></div>

<script>
const LOGO_URL = "icone-512.png";

/* =========================
   CONTROLE DE SUPLEMENTOS
========================= */
const SUPLEMENTOS = {
    ganho: [
        { nome:"Creatina Growth 100g", foto:"creatina-100g.png", link:"https://amzn.to/4b47g9o" },
        { nome:"Whey Chocolate", foto:"wey-choco.png", link:"https://amzn.to/3LjWMIB" },
        { nome:"Whey Morango", foto:"wey-moran.png", link:"https://amzn.to/4sPsdvg" },
        { nome:"Whey Creme", foto:"wey-creme.png", link:"https://amzn.to/4qq9ODl" },
        { nome:"Gainer Chocolate", foto:"Hipercal√≥rico-choco.png", link:"https://amzn.to/4qpZKKC" },
        { nome:"Gainer Cookies", foto:"Hipercal√≥rico-cooki.png", link:"https://amzn.to/4bC9A7C" }
    ],
    perda: [
        { nome:"Psyllium C√°psulas", foto:"Psyllium-caps.png", link:"https://amzn.to/4sBfMmq" },
        { nome:"Psyllium em P√≥", foto:"Psyllium-po.png", link:"https://amzn.to/3YINEAk" },
        { nome:"Ultra Burn Termog√™nico", foto:"termog.png", link:"https://amzn.to/4b5phUQ" },
        { nome:"L-Carnitina 2000mg", foto:"l-creat2000.png", link:"https://amzn.to/4bBHcCw" },
        { nome:"L-Carnitina 1000mg", foto:"l-creat1000.png", link:"https://amzn.to/3LJAv6S" }
    ]
};

/* =========================
   ESTADO GLOBAL COM RESET DI√ÅRIO
========================= */
let hoje = new Date().toDateString();

let estado = JSON.parse(localStorage.getItem("nutrishot_v6")) || {
    logado: false,
    tela: "cadastro",
    nomeUsuario: "Usu√°rio",
    objetivo: "perda",

    peso: 70,
    altura: 170,
    imc: 0,
    classification: "",

    calorias: 0,
    prot: 0,
    carb: 0,
    gord: 0,
    aguaAtual: 0,
    historico: [],

    sequencia: 1,
    ultimoAcesso: hoje,
    dataAtual: hoje,

    progressoSemanal: { 0:0,1:0,2:0,3:0,4:0,5:0,6:0 }
};

function salvar() {
    localStorage.setItem("nutrishot_v6", JSON.stringify(estado));
}

/* =========================
   RESET AUTOM√ÅTICO DI√ÅRIO
========================= */
function verificarNovoDia() {
    const hojeStr = new Date().toDateString();
    if (estado.dataAtual !== hojeStr) {
        const diaSemana = new Date(estado.dataAtual).getDay();
        estado.progressoSemanal[diaSemana] = estado.calorias;

        estado.calorias = 0;
        estado.prot = 0;
        estado.carb = 0;
        estado.gord = 0;
        estado.aguaAtual = 0;
        estado.historico = [];

        estado.dataAtual = hojeStr;
        salvar();
    }
}
/* =========================
   FUN√á√ïES AUXILIARES
========================= */
function infoIMC(peso, altura) {
    const alt = altura / 100;
    const imc = (peso / (alt * alt)).toFixed(1);
    let cls = imc < 18.5 ? "Magreza" :
              imc < 25 ? "Normal" :
              imc < 30 ? "Sobrepeso" :
              imc < 35 ? "Obesidade I" :
              imc < 40 ? "Obesidade II" : "M√≥rbida";
    return { valor: imc, texto: cls };
}

function navegar(tela) {
    estado.tela = tela;
    salvar();
    render();
    window.scrollTo(0,0);
}

function beberAgua() {
    estado.aguaAtual += 250;
    salvar();
    render();
}

/* =========================
   LOGIN / CADASTRO
========================= */
function validarEEntrar() {
    const nome = document.getElementById("nome-f")?.value || "Usu√°rio";
    const peso = parseFloat(document.getElementById("peso-f")?.value || 70);
    const altura = parseFloat(document.getElementById("altura-f")?.value || 170);

    estado.nomeUsuario = nome;
    estado.peso = peso;
    estado.altura = altura;

    const res = infoIMC(peso, altura);
    estado.imc = res.valor;
    estado.classification = res.texto;

    estado.logado = true;
    estado.tela = "home";
    salvar();
    render();
}

/* =========================
   RENDER PRINCIPAL
========================= */
function render() {
    verificarNovoDia();
    const app = document.getElementById("app");

    /* ---------- LOGIN ---------- */
    if (!estado.logado) {
        app.innerHTML = `
            <div style="padding:40px; text-align:center">
                <img src="${LOGO_URL}" style="width:150px"><br><br>
                <input id="nome-f" placeholder="Nome" style="width:90%; padding:12px; margin:5px"><br>
                <input id="peso-f" type="number" placeholder="Peso (kg)" style="width:44%; padding:12px; margin:5px">
                <input id="altura-f" type="number" placeholder="Altura (cm)" style="width:44%; padding:12px; margin:5px"><br>
                <button onclick="validarEEntrar()" style="padding:15px 30px; background:#2490eb; color:#fff; border:none; border-radius:25px; font-weight:bold">ENTRAR</button>
            </div>
        `;
        return;
    }

    /* ---------- DASHBOARD ---------- */
    if (estado.tela === "home") {
        const metaAgua = Math.round(estado.peso * 35);
        const percAgua = Math.min((estado.aguaAtual / metaAgua) * 100, 100);

        const diaHoje = new Date().getDay();

        app.innerHTML = `
            <div style="padding:20px; display:flex; justify-content:space-between">
                <b>Ol√°, ${estado.nomeUsuario}</b>
                <span onclick="navegar('catalogo')" style="cursor:pointer">üõí</span>
            </div>

            <div class="card card-fogo">
                <div>
                    <small>Perfil</small>
                    <div style="font-size:22px; font-weight:bold">${estado.imc}</div>
                    <small>${estado.classification}</small>
                </div>
                <div>
                    üî• ${estado.sequencia} dias
                </div>
            </div>

            <div class="card">
                <b>Hidrata√ß√£o üíß</b>
                <div>${estado.aguaAtual}ml / ${metaAgua}ml</div>
                <div class="progress-container">
                    <div class="progress-bar water" style="width:${percAgua}%"></div>
                </div>
                <button class="btn-water" onclick="beberAgua()">+ 250ml</button>
            </div>

            <div class="ad-banner-container">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-6941311170472131"
                     data-ad-slot="2257554053"
                     data-ad-format="auto"
                     data-ad-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script>
            </div>

            <div class="card">
                <b>Progresso Semanal</b>
                <div class="grid-7">
                    ${[0,1,2,3,4,5,6].map(d => {
                        const ativo = d === diaHoje ? "active" : "";
                        return `<div class="col-dia">
                                    <div class="barra-v ${ativo}"></div>
                                    <span class="dia-txt">${["D","S","T","Q","Q","S","S"][d]}</span>
                                </div>`;
                    }).join("")}
                </div>
            </div>

            <div class="card">
                <b>Calorias Hoje</b>
                <div style="font-size:26px; font-weight:bold">${estado.calorias} kcal</div>
            </div>

            <button class="fab" onclick="navegar('add_refeicao')">+</button>
        `;
        return;
    }

    /* ---------- CAT√ÅLOGO ---------- */
    if (estado.tela === "catalogo") {
        const lista = estado.objetivo === "ganho" ? SUPLEMENTOS.ganho : SUPLEMENTOS.perda;
        app.innerHTML = `
            <div style="padding:20px">
                <b onclick="navegar('home')" style="cursor:pointer">‚Üê Voltar</b>
                <h2>Suplementos</h2>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
                    ${lista.map(p => `
                        <div class="card" style="text-align:center">
                            <img src="${p.foto}" style="width:100%; height:90px; object-fit:contain">
                            <b style="font-size:12px">${p.nome}</b><br>
                            <a href="${p.link}" target="_blank">
                                <button style="margin-top:5px; padding:8px; background:#2ab573; color:#fff; border:none; border-radius:10px">Ver</button>
                            </a>
                        </div>
                    `).join("")}
                </div>
            </div>
        `;
        return;
    }
}
/* =========================
   ADICIONAR REFEI√á√ÉO
========================= */
if (estado.tela === "add_refeicao") {
    app.innerHTML = `
        <div style="padding:20px">
            <b onclick="navegar('home')" style="cursor:pointer">‚Üê Voltar</b>
            <h2 style="text-align:center; margin-top:20px">Adicionar Refei√ß√£o</h2>

            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:20px">
                ${["Caf√©","Almo√ßo","Jantar","Lanche"].map(t => `
                    <div onclick="estado.tempRefeicao='${t}'; salvar(); render()"
                         style="padding:18px; text-align:center; border-radius:15px;
                         border:2px solid ${estado.tempRefeicao===t?'var(--primary)':'#eee'};
                         background:${estado.tempRefeicao===t?'#f0fff7':'#fff'}">
                        <b>${t}</b>
                    </div>
                `).join("")}
            </div>

            <div class="card" style="text-align:center; margin-top:20px">
                <button onclick="simularAnalise()" style="padding:15px; width:100%;
                        background:linear-gradient(to right,#667eea,#764ba2);
                        color:#fff; border:none; border-radius:25px; font-weight:bold">
                    üì∏ ANALISAR REFEI√á√ÉO
                </button>
            </div>
        </div>
    `;
    return;
}

/* =========================
   SIMULA AN√ÅLISE DA IA
========================= */
function simularAnalise() {
    const kcal = Math.floor(Math.random() * 300 + 300);

    estado.calorias += kcal;
    estado.prot += Math.floor(kcal * 0.05);
    estado.carb += Math.floor(kcal * 0.12);
    estado.gord += Math.floor(kcal * 0.03);

    estado.historico.unshift({
        tipo: estado.tempRefeicao,
        cal: kcal
    });

    salvar();
    estado.ultimoResultado = { tipo: estado.tempRefeicao, cal: kcal };
    navegar("resultado");
}

/* =========================
   RESULTADO DA AN√ÅLISE
========================= */
if (estado.tela === "resultado") {
    app.innerHTML = `
        <div style="min-height:85vh; display:flex; flex-direction:column;
                    justify-content:center; align-items:center; padding:30px; text-align:center">
            <div style="font-size:60px">üöÄ</div>
            <h2>An√°lise Conclu√≠da</h2>
            <p style="font-size:24px">
                ${estado.ultimoResultado.tipo} ‚âà
                <b style="color:var(--primary)">${estado.ultimoResultado.cal} kcal</b>
            </p>
            <button onclick="navegar('home')" style="margin-top:20px;
                    padding:15px 30px; background:#2490eb; color:#fff;
                    border:none; border-radius:25px; font-weight:bold">
                VOLTAR AO DASHBOARD
            </button>
        </div>
    `;
    return;
}

/* =========================
   DICA DI√ÅRIA
========================= */
if (estado.tela === "dica") {
    app.innerHTML = `
        <div style="min-height:85vh; display:flex; flex-direction:column;
                    justify-content:center; align-items:center; padding:30px; text-align:center">
            <div style="font-size:60px">üí°</div>
            <h2>Dica NutriShot</h2>
            <p style="font-size:24px; line-height:1.3">
                Mastigar devagar melhora a digest√£o e ajuda no controle do apetite.
            </p>
            <button onclick="navegar('home')" style="margin-top:20px;
                    padding:15px 30px; background:#2ab573; color:#fff;
                    border:none; border-radius:25px; font-weight:bold">
                CONTINUAR
            </button>
        </div>
    `;
    return;
}

/* =========================
   INICIALIZA√á√ÉO FINAL
========================= */
verificarNovoDia();
render();
</script>
</body>
</html>
