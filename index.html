<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>NutriShot Elements</title>

<!-- AdSense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6941311170472131" crossorigin="anonymous"></script>

<style>
:root{
 --primary:#2ab573;
 --blue-action:#2490eb;
 --bg:#f9fafb;
 --water:#3498db;
}
body{margin:0;font-family:'Segoe UI',Roboto,sans-serif;background:var(--bg);color:#333;padding-bottom:40px}
.sidebar{position:fixed;top:0;left:-280px;width:280px;height:100%;background:#fff;z-index:10000;transition:.3s;box-shadow:2px 0 15px rgba(0,0,0,.1);display:flex;flex-direction:column}
.sidebar.active{left:0}
.sidebar-header{padding:40px 20px;background:linear-gradient(135deg,var(--blue-action),var(--primary));color:#fff}
.sidebar-menu{padding:20px 0;flex-grow:1}
.menu-item{padding:15px 25px;cursor:pointer;font-weight:500}
.menu-item:hover{background:#f0f7f4;color:var(--primary)}
.sidebar-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:none;z-index:9999}
.sidebar-overlay.active{display:block}

.card{background:#fff;border-radius:20px;padding:20px;margin:15px 20px;border:1px solid #eee}
.btn-azul{width:calc(100% - 40px);margin:10px 20px;padding:18px;border-radius:30px;border:none;background:var(--blue-action);color:#fff;font-weight:bold}
.progress-container{height:10px;background:#eee;border-radius:10px;overflow:hidden}
.progress-bar{height:100%;background:var(--primary)}
.progress-bar.water{background:var(--water)}
.ad-banner-container{margin:20px;text-align:center;min-height:60px}
.refeicao-item{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #eee}
</style>
</head>

<body>

<div id="ads-overlay" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#000;color:#fff;z-index:99999;align-items:center;justify-content:center;flex-direction:column">
<b id="ad-text">Processando...</b>
<div style="width:70%;height:8px;background:#333;margin-top:20px;border-radius:10px">
<div id="bar-progress" style="width:0;height:100%;background:#2ab573"></div>
</div>
</div>

<div id="app"></div>

<script>
const LOGO_URL="icone-512.png";

let estado=JSON.parse(localStorage.getItem("nutrishot_v6"))||{
 logado:false,tela:"cadastro",nomeUsuario:"Usu√°rio",
 peso:70,altura:170,imc:0,classification:"",
 calorias:0,aguaAtual:0,
 historico:[],
 ultimoAcesso:new Date().toDateString()
};

function salvar(){localStorage.setItem("nutrishot_v6",JSON.stringify(estado))}
function navegar(t){estado.tela=t;salvar();render();window.scrollTo(0,0)}

function infoIMC(p,a){
 const imc=(p/((a/100)**2)).toFixed(1);
 const c=imc<18.5?"Magreza":imc<25?"Normal":imc<30?"Sobrepeso":"Obesidade";
 return{imc,c};
}

function carregarBannerAdMob(){
 try{(adsbygoogle=window.adsbygoogle||[]).push({})}
 catch(e){console.warn("Ads ainda n√£o prontos")}
}

function rodarAnuncio(txt,cb){
 const o=document.getElementById("ads-overlay");
 const b=document.getElementById("bar-progress");
 document.getElementById("ad-text").innerText=txt;
 o.style.display="flex";let p=0;
 const t=setInterval(()=>{
  p+=5;b.style.width=p+"%";
  if(p>=100){clearInterval(t);o.style.display="none";b.style.width="0%";cb()}
 },60)
}

function beberAgua(){
 estado.aguaAtual+=250;
 estado.historico.push({
  tipo:"√Ågua",
  cal:0,
  data:new Date().toDateString()
 });
 salvar();render();
}

function confirmarAnalise(){
 rodarAnuncio("Analisando refei√ß√£o...",()=>{
  const cal=Math.floor(Math.random()*300+300);
  estado.calorias+=cal;
  estado.historico.push({
   tipo:"Refei√ß√£o",
   cal,
   data:new Date().toDateString()
  });
  salvar();navegar("home");
 });
}

function historicoPorDia(){
 const d={};
 estado.historico.forEach(i=>{
  if(!d[i.data])d[i.data]={cal:0,itens:[]};
  d[i.data].cal+=i.cal;
  d[i.data].itens.push(i);
 });
 return d;
}

function render(){
 const root=document.getElementById("app");

 if(!estado.logado){
  root.innerHTML=`
   <div style="padding:40px;text-align:center">
    <img src="${LOGO_URL}" width="120"><h2>NutriShot Elements</h2>
    <input placeholder="Nome" id="nome" style="width:80%;padding:10px"><br><br>
    <button class="btn-azul" onclick="
      estado.nomeUsuario=document.getElementById('nome').value||'Usu√°rio';
      const r=infoIMC(estado.peso,estado.altura);
      estado.imc=r.imc;estado.classification=r.c;
      estado.logado=true;navegar('home')
    ">Entrar</button>
   </div>`;
  return;
 }

 if(estado.tela==="home"){
  root.innerHTML=`
  <div id="sidebar-overlay" class="sidebar-overlay" onclick="toggleMenu()"></div>
  <div id="sidebar" class="sidebar">
   <div class="sidebar-header"><b>${estado.nomeUsuario}</b></div>
   <div class="sidebar-menu">
    <div class="menu-item" onclick="navegar('home')">üè† Dashboard</div>
    <div class="menu-item" onclick="navegar('historico')">üìä Hist√≥rico Di√°rio</div>
    <div class="menu-item" onclick="rodarAnuncio('Saindo...',()=>{estado.logado=false;render()})">üö™ Sair</div>
   </div>
  </div>

  <div style="padding:20px;display:flex;justify-content:space-between">
   <div onclick="toggleMenu()" style="font-size:24px">‚ò∞</div>
   <b>${estado.nomeUsuario}</b>
  </div>

  <div class="card">
   <b>Hidrata√ß√£o</b>
   <div>${estado.aguaAtual}ml</div>
   <div class="progress-container">
    <div class="progress-bar water" style="width:${Math.min(estado.aguaAtual/2500*100,100)}%"></div>
   </div>
   <button onclick="beberAgua()">+ 250ml</button>
  </div>

  <div class="ad-banner-container">
   <ins class="adsbygoogle"
    style="display:block"
    data-ad-client="ca-pub-6941311170472131"
    data-ad-slot="2257554053"
    data-ad-format="auto"
    data-ad-full-width-responsive="true"></ins>
  </div>

  <div class="card">
   <b>Calorias</b>
   <div>${estado.calorias} kcal</div>
  </div>

  <button class="btn-azul" onclick="confirmarAnalise()">Adicionar Refei√ß√£o</button>
  `;
  setTimeout(carregarBannerAdMob,300);
  return;
 }

 if(estado.tela==="historico"){
  const h=historicoPorDia();
  const datas=Object.keys(h).sort((a,b)=>new Date(b)-new Date(a));
  root.innerHTML=`
  <div style="padding:20px">
   <div onclick="navegar('home')" style="cursor:pointer;color:var(--blue-action)">‚Üê Voltar</div>
   <h2>Hist√≥rico Di√°rio</h2>
   ${datas.length===0?"<p>Nenhum registro</p>":
    datas.map(d=>`
     <div class="card">
      <b>${d}</b>
      <div>üî• ${h[d].cal} kcal</div>
      ${h[d].itens.map(i=>`
       <div class="refeicao-item">
        <span>${i.tipo}</span>
        <span>${i.cal>0?i.cal+" kcal":"üíß"}</span>
       </div>`).join("")}
     </div>`).join("")
   }
  </div>`;
  return;
 }
}

function toggleMenu(){
 document.getElementById("sidebar").classList.toggle("active");
 document.getElementById("sidebar-overlay").classList.toggle("active");
}

render();
</script>
</body>
</html>
