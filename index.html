<script>
function processarFoto() {
    rodarAnuncio("Analisando com IA NutriShot...", () => {

        // Calorias estimadas
        const calorias = Math.floor(Math.random() * 200 + 350);

        // Distribuição nutricional
        const proteina = Math.round((calorias * 0.20) / 4); // 20%
        const carbo = Math.round((calorias * 0.50) / 4);    // 50%
        const gordura = Math.round((calorias * 0.30) / 9);  // 30%

        // Atualiza totais
        estado.calorias += calorias;
        estado.prot += proteina;
        estado.carb += carbo;
        estado.gord += gordura;

        // Histórico detalhado
        estado.historico.unshift({
            tipo: estado.tempRefeicao,
            cal: calorias,
            prot: proteina,
            carb: carbo,
            gord: gordura,
            data: new Date().toISOString()
        });

        salvar();
        navegar('home');
    });
}
</script>
