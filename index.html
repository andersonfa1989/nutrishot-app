<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NutriShot Elements</title>

<style>
:root {
  --primary:#2ab573;
  --blue:#2490eb;
  --bg:#f9fafb;
}
body{margin:0;font-family:Segoe UI,Roboto,sans-serif;background:var(--bg)}
.card{background:#fff;border-radius:16px;padding:15px;margin:15px;border:1px solid #eee}
.menu-item{padding:15px 25px;cursor:pointer}
.menu-item:hover{background:#f0f7f4}
.sidebar{position:fixed;left:-280px;top:0;width:280px;height:100%;background:#fff;transition:.3s;z-index:9999}
.sidebar.active{left:0}
.sidebar-overlay{position:fixed;top:0;left:0;width:100%;height:100%;display:none;background:rgba(0,0,0,.4)}
.sidebar-overlay.active{display:block}
.progress-bar{height:8px;background:var(--primary);border-radius:8px}
.fab{position:fixed;bottom:20px;right:20px;width:60px;height:60px;border-radius:50%;border:none;font-size:30px;background:#000;color:#fff}
</style>
</head>

<body>

<div id="overlay" class="sidebar-overlay" onclick="toggleMenu()"></div>
<div id="sidebar" class="sidebar">
  <div style="padding:20px;background:linear-gradient(135deg,var(--blue),var(--primary));color:#fff">
    <b>NutriShot</b><br><small id="userNome"></small>
  </div>
  <div class="menu-item" onclick="go('home')">üè† Dashboard</div>
  <div class="menu-item" onclick="go('progresso')">üìä Progresso Semanal</div>
  <div class="menu-item" onclick="go('catalogo')">üõí Loja</div>
  <div class="menu-item" onclick="logout()" style="color:#e74c3c">üö™ Sair</div>
</div>

<div id="app"></div>

<script>
'use strict';

const hojeStr = () => new Date().toDateString();
const diaSemana = () => ['Dom','Seg','Ter','Qua','Qui','Sex','Sab'][new Date().getDay()];

let estado = JSON.parse(localStorage.getItem('nutrishot')) || {
  logado:true,
  nome:'Usu√°rio',
  tela:'home',
  calorias:0,
  prot:0,
  carb:0,
  gord:0,
  agua:0,
  historico:[],
  sequencia:1,
  ultimoAcesso:hojeStr(),
  ultimoResetDia:hojeStr(),
  progressoSemanal:{}
};

function salvar(){localStorage.setItem('nutrishot',JSON.stringify(estado));}

function resetDiario(){
  if(estado.ultimoResetDia !== hojeStr()){
    const dia = diaSemana();
    estado.progressoSemanal[dia] = estado.calorias;

    estado.calorias = 0;
    estado.prot = 0;
    estado.carb = 0;
    estado.gord = 0;
    estado.agua = 0;
    estado.historico = [];

    estado.ultimoResetDia = hojeStr();
    salvar();
  }
}

function verificarSequencia(){
  const ontem = new Date(); ontem.setDate(ontem.getDate()-1);
  if(estado.ultimoAcesso !== hojeStr()){
    estado.sequencia = (estado.ultimoAcesso === ontem.toDateString()) ? estado.sequencia+1 : 1;
    estado.ultimoAcesso = hojeStr();
    salvar();
  }
}

function toggleMenu(){
  document.getElementById('sidebar').classList.toggle('active');
  document.getElementById('overlay').classList.toggle('active');
}

function go(t){estado.tela=t;salvar();render();toggleMenu();}

function logout(){
  estado.logado=false;
  salvar();
  render();
}

function render(){
  resetDiario();
  verificarSequencia();

  document.getElementById('userNome').innerText = estado.nome;
  const app = document.getElementById('app');

  if(estado.tela==='home'){
    app.innerHTML = `
    <div style="padding:20px">
      <div onclick="toggleMenu()" style="font-size:22px">‚ò∞</div>
      <div class="card">
        <b>Sequ√™ncia üî•</b><br>
        ${estado.sequencia} dias
      </div>
      <div class="card">
        <b>Calorias Hoje</b>
        <div>${estado.calorias} kcal</div>
        <div class="progress-bar" style="width:${Math.min(estado.calorias/2500*100,100)}%"></div>
      </div>
    </div>
    <button class="fab" onclick="addRefeicao()">+</button>`;
  }

  if(estado.tela==='progresso'){
    const dias = ['Seg','Ter','Qua','Qui','Sex','Sab','Dom'];
    app.innerHTML = `
    <div style="padding:20px">
      <b style="font-size:18px">üìä Progresso Semanal</b>
      ${dias.map(d=>`
        <div class="card">
          <b>${d}</b>
          <div>${estado.progressoSemanal[d]||0} kcal</div>
          <div class="progress-bar" style="width:${Math.min((estado.progressoSemanal[d]||0)/2500*100,100)}%"></div>
        </div>
      `).join('')}
    </div>`;
  }
}

function addRefeicao(){
  const cal = Math.floor(Math.random()*400+200);
  estado.calorias+=cal;
  estado.historico.push(cal);
  salvar();
  render();
}

render();
</script>

</body>
</html>
